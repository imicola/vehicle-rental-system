# è½¦è¾†ç§Ÿè´·ç®¡ç†ç³»ç»Ÿ - é…ç½®å®Œæˆæ€»ç»“

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®åº“è„šæœ¬ (schema.sql)
âœ… åˆ›å»ºäº†å®Œæ•´çš„PostgreSQLæ•°æ®åº“è„šæœ¬ï¼ŒåŒ…å«ï¼š
- **7ä¸ªæ ¸å¿ƒæ•°æ®è¡¨**ï¼šstores, categories, users, vehicles, orders, payments, maintenance
- **å®Œæ•´çš„å¤–é”®çº¦æŸ**ï¼šç¡®ä¿æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§
- **è‡ªåŠ¨ç´¢å¼•ä¼˜åŒ–**ï¼šä¸ºæŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
- **åˆå§‹ç¤ºä¾‹æ•°æ®**ï¼š3ä¸ªé—¨åº—ã€3ä¸ªåˆ†ç±»ã€4ä¸ªç”¨æˆ·

**ä½ç½®**: `src/main/resources/schema.sql`

### 2. Spring Bootæ•°æ®åº“é…ç½® (application.properties)
âœ… é…ç½®äº†å®Œæ•´çš„æ•°æ®åº“è¿æ¥å’ŒORMæ¡†æ¶ï¼š
- PostgreSQL JDBCè¿æ¥å­—ç¬¦ä¸²
- JPA/Hibernateé…ç½®
- HikariCPè¿æ¥æ± é…ç½®
- SQLè‡ªåŠ¨åˆå§‹åŒ–è®¾ç½®

**ä½ç½®**: `src/main/resources/application.properties`

### 3. Mavenä¾èµ– (pom.xml)
âœ… æ·»åŠ äº†å¿…è¦çš„ä¾èµ–åº“ï¼š
- `spring-boot-starter-data-jpa` - JPA ORMæ¡†æ¶
- `org.postgresql:postgresql` - PostgreSQL JDBCé©±åŠ¨
- `org.projectlombok:lombok` - ç®€åŒ–Javaä»£ç ç¼–å†™

### 4. æ–‡æ¡£å’Œå·¥å…·

âœ… **DATABASE_SETUP.md** (è¯¦ç»†é…ç½®æŒ‡å—)
- å®Œæ•´çš„å‰ç½®è¦æ±‚è¯´æ˜
- åˆ†æ­¥éª¤çš„é…ç½®è¯´æ˜
- å¸¸è§é—®é¢˜è§£ç­”

âœ… **QUICK_START.md** (å¿«é€Ÿå‚è€ƒ)
- 5æ­¥å¿«é€Ÿå¼€å§‹æŒ‡å—
- å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨
- æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯

âœ… **verify_database.sql** (æ•°æ®åº“éªŒè¯è„šæœ¬)
- éªŒè¯æ‰€æœ‰è¡¨æ˜¯å¦åˆ›å»ºæˆåŠŸ
- æ˜¾ç¤ºè¡¨ç»“æ„å’Œå¤–é”®å…³ç³»
- æŸ¥è¯¢ç¤ºä¾‹

âœ… **sample_data.sql** (æµ‹è¯•æ•°æ®è„šæœ¬)
- æ’å…¥15è¾†æµ‹è¯•è½¦è¾†
- æ’å…¥6ä¸ªæµ‹è¯•è®¢å•
- æ’å…¥ç»´ä¿®è®°å½•å’Œæ”¯ä»˜è®°å½•

âœ… **init_database.sh** (Linux/Macè‡ªåŠ¨åˆå§‹åŒ–)
âœ… **init_database.bat** (Windowsè‡ªåŠ¨åˆå§‹åŒ–)

---

## ğŸš€ ç«‹å³å¼€å§‹

### ç¬¬1æ­¥ï¼šå®‰è£…PostgreSQL
```bash
# Ubuntu/Debian
sudo apt-get install postgresql postgresql-contrib

# macOS
brew install postgresql

# Windowsï¼šä» https://www.postgresql.org/download/windows/ ä¸‹è½½å®‰è£…
```

### ç¬¬2æ­¥ï¼šåˆ›å»ºæ•°æ®åº“å¹¶åˆå§‹åŒ–
```bash
# Linux/Mac (è‡ªåŠ¨è„šæœ¬)
bash init_database.sh

# Windows (è‡ªåŠ¨è„šæœ¬)
init_database.bat

# æˆ–æ‰‹åŠ¨æ‰§è¡Œ
psql -U postgres
CREATE DATABASE vehicle_rental;
\q
psql -U postgres -d vehicle_rental -f src/main/resources/schema.sql
```

### ç¬¬3æ­¥ï¼šä¿®æ”¹æ•°æ®åº“å¯†ç ï¼ˆå¦‚éœ€ï¼‰
ç¼–è¾‘ `src/main/resources/application.properties`
```properties
spring.datasource.password=ä½ çš„å®é™…å¯†ç 
```

### ç¬¬4æ­¥ï¼šä¸‹è½½ä¾èµ–
```bash
mvn clean install
```

### ç¬¬5æ­¥ï¼šå¯åŠ¨åº”ç”¨
```bash
mvn spring-boot:run
```

---

## ğŸ“Š æ•°æ®åº“æ¶æ„

### æ ¸å¿ƒè¡¨ç»“æ„

```
stores (é—¨åº—)
â”œâ”€ id (PK)
â”œâ”€ name
â”œâ”€ address
â””â”€ phone

categories (åˆ†ç±»)
â”œâ”€ id (PK)
â”œâ”€ name
â””â”€ basic_rate

users (ç”¨æˆ·)
â”œâ”€ id (PK)
â”œâ”€ username
â”œâ”€ password
â”œâ”€ phone
â””â”€ role

vehicles (è½¦è¾†) â­ æ ¸å¿ƒè¡¨
â”œâ”€ id (PK)
â”œâ”€ plate_number
â”œâ”€ model
â”œâ”€ category_id (FK â†’ categories)
â”œâ”€ store_id (FK â†’ stores)
â”œâ”€ status (0:ç©ºé—², 1:å·²ç§Ÿ, 2:ç»´ä¿®, 3:è°ƒæ‹¨ä¸­)
â””â”€ daily_rate

orders (è®¢å•) â­ æ ¸å¿ƒè¡¨
â”œâ”€ id (PK)
â”œâ”€ order_no
â”œâ”€ user_id (FK â†’ users)
â”œâ”€ vehicle_id (FK â†’ vehicles)
â”œâ”€ pickup_store_id (FK â†’ stores)
â”œâ”€ return_store_id (FK â†’ stores)
â”œâ”€ start_time
â”œâ”€ end_time
â”œâ”€ actual_return_time
â”œâ”€ total_amount
â””â”€ status (0:é¢„è®¢, 1:ä½¿ç”¨ä¸­, 2:å·²è¿˜è½¦, 3:å·²å–æ¶ˆ)

payments (æ”¯ä»˜)
â”œâ”€ id (PK)
â”œâ”€ order_id (FK â†’ orders)
â”œâ”€ amount
â”œâ”€ pay_method
â”œâ”€ pay_type (Deposit/Final/Penalty)
â””â”€ pay_time

maintenance (ç»´ä¿®)
â”œâ”€ id (PK)
â”œâ”€ vehicle_id (FK â†’ vehicles)
â”œâ”€ type (ç»´ä¿®/ä¿å…»/å¹´æ£€)
â”œâ”€ start_date
â”œâ”€ end_date
â”œâ”€ cost
â””â”€ description
```

---

## ğŸ”‘ å…³é”®ä¸šåŠ¡æµç¨‹

### å®Œæ•´ç§Ÿè½¦æµç¨‹ (å¼‚åœ°è¿˜è½¦)

**Step 1: é¢„è®¢**
```
ç”¨æˆ·Aåœ¨appä¸Šé¢„è®¢ï¼š
- è½¦è¾†ï¼šåŒ—äº¬çš„Model 3 (vehicle_id=8)
- å–è½¦é—¨åº—ï¼šåŒ—äº¬æœé˜³åº— (pickup_store_id=1)
- è¿˜è½¦é—¨åº—ï¼šå¤©æ´¥æ²³è¥¿åº— (return_store_id=2)
- ç§ŸæœŸï¼š2024-01-15 è‡³ 2024-01-17

è®¢å•çŠ¶æ€ï¼š0 (é¢„è®¢)
è½¦è¾†çŠ¶æ€ï¼š0 (ç©ºé—²)
```

**Step 2: å–è½¦ (Check-out)**
```
ç”¨æˆ·åˆ°è¾¾åŒ—äº¬æœé˜³åº—ï¼ŒåŠç†å–è½¦ï¼š
- æ”¯ä»˜æŠ¼é‡‘ï¼š100å…ƒ (payments.pay_type='Deposit')
- è®¢å•çŠ¶æ€ï¼š0 â†’ 1 (ä½¿ç”¨ä¸­)
- è½¦è¾†çŠ¶æ€ï¼š0 â†’ 1 (å·²ç§Ÿ)
- è½¦è¾†ä½ç½®ï¼šä»åœ¨åŒ—äº¬ (store_id=1)
```

**Step 3: ä½¿ç”¨ä¸­**
```
ç”¨æˆ·è‡ª2024-01-15å¼€å§‹ä½¿ç”¨è½¦è¾†
- è®¢å•çŠ¶æ€ä¿æŒï¼š1 (ä½¿ç”¨ä¸­)
- è½¦è¾†çŠ¶æ€ä¿æŒï¼š1 (å·²ç§Ÿ)
```

**Step 4: è¿˜è½¦ (Check-in)**
```
ç”¨æˆ·åˆ°è¾¾å¤©æ´¥æ²³è¥¿åº—ï¼ŒåŠç†è¿˜è½¦ï¼š
- è®°å½•è¿˜è½¦æ—¶é—´ï¼šactual_return_time
- è®¡ç®—ç§ŸæœŸè´¹ç”¨
- å¦‚æœ‰é€¾æœŸï¼ŒåŠ æ”¶ç½šé‡‘
- æ”¯ä»˜å°¾æ¬¾ï¼š100å…ƒ (payments.pay_type='Final')
- æ”¯ä»˜ç½šé‡‘ï¼š20å…ƒ (payments.pay_type='Penalty') ã€å¦‚æœ‰ã€‘
- è®¢å•çŠ¶æ€ï¼š1 â†’ 2 (å·²å®Œæˆ)
- è½¦è¾†çŠ¶æ€ï¼š1 â†’ 0 (ç©ºé—²)
- è½¦è¾†ä½ç½®ï¼šæ›´æ–°ä¸ºå¤©æ´¥ (store_id=2) â­ å…³é”®ï¼
- æ€»é‡‘é¢ (total_amount)ï¼š100 + 100 + 20 = 220å…ƒ
```

---

## ğŸ’¡ å…³é”®è®¾è®¡ç‚¹

### 1. å¼‚åœ°è¿˜è½¦æ”¯æŒ
- è®¢å•è¡¨æœ‰ä¸¤ä¸ªé—¨åº—å­—æ®µï¼š`pickup_store_id` å’Œ `return_store_id`
- è½¦è¾†çš„ `store_id` ä¼šéšç€è¿˜è½¦ä½ç½®è‡ªåŠ¨æ›´æ–°
- æ”¯æŒå¼‚åœ°è¿˜è½¦çš„ä¸šåŠ¡æ¨¡å¼

### 2. çµæ´»çš„æ”¯ä»˜æ¨¡å¼
- `payments` è¡¨å•ç‹¬è®¾è®¡ï¼Œæ”¯æŒå¤šæ¬¡æ”¯ä»˜
- æ”¯ä»˜ç±»å‹åŒºåˆ†ï¼šæŠ¼é‡‘ã€å°¾æ¬¾ã€ç½šé‡‘
- å¯è¿½è¸ªå®Œæ•´çš„æ”¯ä»˜è®°å½•

### 3. è½¦è¾†çŠ¶æ€ç®¡ç†
- 0: ç©ºé—² - å¯ä»¥å‡ºç§Ÿ
- 1: å·²ç§Ÿ - æ­£åœ¨ä½¿ç”¨ä¸­
- 2: ç»´ä¿® - ç»´æŠ¤ä¸­æ— æ³•å‡ºç§Ÿ
- 3: è°ƒæ‹¨ä¸­ - åœ¨é—¨åº—é—´è½¬ç§»

### 4. ç”¨æˆ·è§’è‰²æ”¯æŒ
- 0: å®¢æˆ· - å¯ä»¥åˆ›å»ºè®¢å•ã€æ”¯ä»˜
- 1: ç®¡ç†å‘˜ - ç³»ç»Ÿç®¡ç†æƒé™
- 2: é—¨åº—å‘˜å·¥ - ç®¡ç†é—¨åº—ä¸šåŠ¡

### 5. æ•°æ®å®Œæ•´æ€§ä¿è¯
- å®Œæ•´çš„å¤–é”®çº¦æŸ
- çº§è”åˆ é™¤é…ç½®åˆç†
- è‡ªåŠ¨æ—¶é—´æˆ³ (created_at, updated_at)

---

## ğŸ“‹ æ–‡ä»¶æ¸…å•

| æ–‡ä»¶ | å¤§å° | è¯´æ˜ |
|------|------|------|
| schema.sql | 6.5KB | æ ¸å¿ƒæ•°æ®åº“è„šæœ¬ |
| application.properties | 1.5KB | Spring Booté…ç½® |
| pom.xml | 3.2KB | Mavenä¾èµ–ï¼ˆå·²æ›´æ–°ï¼‰ |
| DATABASE_SETUP.md | 8.5KB | è¯¦ç»†é…ç½®æŒ‡å— |
| QUICK_START.md | 10.2KB | å¿«é€Ÿå‚è€ƒ |
| verify_database.sql | 4.8KB | éªŒè¯è„šæœ¬ |
| sample_data.sql | 6.3KB | æµ‹è¯•æ•°æ® |
| init_database.sh | 1.2KB | Linux/Macåˆå§‹åŒ– |
| init_database.bat | 1.5KB | Windowsåˆå§‹åŒ– |

**æ€»è®¡**: çº¦43KBçš„é…ç½®æ–‡ä»¶å’Œè„šæœ¬

---

## ğŸ¯ åç»­å¼€å‘æ­¥éª¤

### Phase 1: æ•°æ®è®¿é—®å±‚ âœ… å·²å®Œæˆ
- âœ… æ•°æ®åº“è®¾è®¡
- âœ… SQLè„šæœ¬åˆ›å»º
- âœ… è¿æ¥é…ç½®

### Phase 2: Entityå’ŒRepository
- â­ï¸ åˆ›å»ºJPA Entityç±»ï¼ˆä¸è¡¨å¯¹åº”ï¼‰
- â­ï¸ åˆ›å»ºRepositoryæ¥å£
- â­ï¸ æ·»åŠ æŸ¥è¯¢æ–¹æ³•

### Phase 3: ä¸šåŠ¡é€»è¾‘å±‚
- â­ï¸ ç¼–å†™Serviceç±»
- â­ï¸ å®ç°ä¸šåŠ¡é€»è¾‘
- â­ï¸ å¼‚å¸¸å¤„ç†

### Phase 4: APIå±‚
- â­ï¸ ç¼–å†™REST Controller
- â­ï¸ å‚æ•°éªŒè¯
- â­ï¸ è¿”å›æ ¼å¼ç»Ÿä¸€

### Phase 5: æµ‹è¯•
- â­ï¸ å•å…ƒæµ‹è¯•
- â­ï¸ é›†æˆæµ‹è¯•
- â­ï¸ ç«¯åˆ°ç«¯æµ‹è¯•

---

## ğŸ” éªŒè¯æ¸…å•

å¯åŠ¨åº”ç”¨åï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤éªŒè¯ï¼š

- [ ] åº”ç”¨å¯åŠ¨æˆåŠŸï¼Œæ— æ•°æ®åº“è¿æ¥é”™è¯¯
- [ ] æ‰§è¡Œ `verify_database.sql` æŸ¥çœ‹æ‰€æœ‰è¡¨å·²åˆ›å»º
- [ ] æŸ¥çœ‹ `stores` è¡¨æœ‰3æ¡åˆå§‹æ•°æ®
- [ ] æŸ¥çœ‹ `categories` è¡¨æœ‰3æ¡åˆå§‹æ•°æ®
- [ ] æŸ¥çœ‹ `users` è¡¨æœ‰4æ¡åˆå§‹æ•°æ®
- [ ] æ‰§è¡Œ `sample_data.sql` æ·»åŠ æµ‹è¯•æ•°æ®
- [ ] æŸ¥çœ‹ `vehicles` è¡¨æœ‰15è¾†è½¦
- [ ] æŸ¥çœ‹ `orders` è¡¨æœ‰6ä¸ªè®¢å•

---

## ğŸ“ å¸¸è§é—®é¢˜é€ŸæŸ¥

**Q: æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ**
A: æ£€æŸ¥PostgreSQLæ˜¯å¦å¯åŠ¨ï¼Œç¡®è®¤ç”¨æˆ·åå¯†ç æ­£ç¡®

**Q: è¡¨æœªè‡ªåŠ¨åˆ›å»ºï¼Ÿ**
A: æ‰‹åŠ¨æ‰§è¡Œ `schema.sql` è„šæœ¬ï¼Œæˆ–æ£€æŸ¥ `spring.sql.init.mode` é…ç½®

**Q: å¿˜è®°PostgreSQLå¯†ç ï¼Ÿ**
A: Linuxç”¨æˆ·å¯ä½¿ç”¨ `sudo -u postgres psql` é‡ç½®

**Q: å¦‚ä½•é‡ç½®æ‰€æœ‰æ•°æ®ï¼Ÿ**
A: æ”¹ `ddl-auto=create-drop` é‡å¯åº”ç”¨ï¼ˆè°¨æ…ä½¿ç”¨ï¼ï¼‰

æ›´å¤šé—®é¢˜è§ `DATABASE_SETUP.md` çš„å¸¸è§é—®é¢˜ç« èŠ‚

---

## ğŸ‰ å®Œæˆï¼

æ­å–œï¼æ•°æ®åº“é…ç½®å·²å…¨éƒ¨å®Œæˆã€‚

**ä¸‹ä¸€æ­¥**: é˜…è¯» `QUICK_START.md` å¿«é€Ÿå¼€å§‹ï¼Œæˆ–å‚è€ƒ `DATABASE_SETUP.md` äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚

æœ‰ä»»ä½•é—®é¢˜ï¼Œå¯ä»¥æŸ¥çœ‹å¯¹åº”çš„æ–‡æ¡£æ–‡ä»¶è·å–å¸®åŠ©ã€‚

---

**æœ€åæ›´æ–°**: 2024-12-24
**ç‰ˆæœ¬**: 1.0
